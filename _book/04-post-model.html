<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.38">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Unofficial NWFSC Stock Assessment Handbook - 4&nbsp; So you ran an assessment model</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./05-other.html" rel="next">
<link href="./03-stock-synthesis.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">So you ran an assessment model</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Unofficial NWFSC Stock Assessment Handbook</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/thefaylab/lab-manual" title="Source Code" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-data-sources.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Data sources: notes, contact information, and links</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-model-choices.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Modeling choices</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-stock-synthesis.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Running Stock Synthesis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-post-model.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">So you ran an assessment model</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-other.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Other useful tidbits</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix-a.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Appendix A: Species seen* in the hake fishery</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix-b.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Appendix B: Alaska Center CRUISEJOINS for shelf and slope surveys</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#notes-and-best-practices-for-retrospectives" id="toc-notes-and-best-practices-for-retrospectives" class="nav-link active" data-scroll-target="#notes-and-best-practices-for-retrospectives"> <span class="header-section-number">4.1</span> Notes and best practices for retrospectives</a></li>
  <li><a href="#notes-and-best-practices-for-andres-rebuilder-program-aka-puntalyzer" id="toc-notes-and-best-practices-for-andres-rebuilder-program-aka-puntalyzer" class="nav-link" data-scroll-target="#notes-and-best-practices-for-andres-rebuilder-program-aka-puntalyzer"> <span class="header-section-number">4.2</span> Notes and best practices for Andre’s rebuilder program (aka Puntalyzer)</a></li>
  <li><a href="#notes-and-best-practices-for-r4ss" id="toc-notes-and-best-practices-for-r4ss" class="nav-link" data-scroll-target="#notes-and-best-practices-for-r4ss"> <span class="header-section-number">4.3</span> Notes and best practices for <code>r4ss</code></a></li>
  <li><a href="#notes-and-best-practices-for-writing-assessment-documents" id="toc-notes-and-best-practices-for-writing-assessment-documents" class="nav-link" data-scroll-target="#notes-and-best-practices-for-writing-assessment-documents"> <span class="header-section-number">4.4</span> Notes and best practices for writing assessment documents</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/thefaylab/lab-manual/edit/main/04-post-model.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/thefaylab/lab-manual/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">So you ran an assessment model</span></h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<section id="notes-and-best-practices-for-retrospectives" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="notes-and-best-practices-for-retrospectives"><span class="header-section-number">4.1</span> Notes and best practices for retrospectives</h2>
<ol type="1">
<li><p>Retrospective analysis is a way to assess whether something is inconsistent in data or model assumptions. A retrospective pattern can arise from changes in catch, M, q, selectivity, or growth from that which is in the model. It is primarily an exploratory/diagnostic tool, though see point 4 below.</p></li>
<li><p>See the 11/17/2021 <a href="https://docs.google.com/presentation/d/1ZfW1-d6x-lzhxLZpYQhlIAFuAW8ij_e5oEEV0ujwP5A/edit#slide=id.gf83411298e_0_18">PEP team meeting presentation</a> for background information and past publications on retrospective analysis</p></li>
<li><p>PEP’s approach is to apply:</p>
<ol type="a">
<li><p>5 years of peels (based on findings from Miller and Legault 2017),</p></li>
<li><p>using the alternative Mohn’s rho (Mohn’s rho averaged over peels - the AFSC_Hurtado term from <code>r4ss::SSmohnsrho</code>),</p></li>
<li><p>for depletion, biomass, fishing mortality, and recruitment. Often biomass, depletion, and recruitment are provided in assessment reports</p></li>
</ol></li>
</ol>
<!-- -->
<ol start="4" type="1">
<li><p>Although the east coast uses mohn’s rho to “correct” status indicators or when setting quotas, our practice is not to. This is based on past precedent, and that our fishing history is not as long as it is on the east coast.</p></li>
<li><p>Hurtado-Ferro et al.&nbsp;(2015) provide a rule of thumb on the significance of mohn’s rho (average over peels) dependent on life history. They suggest a retrospective pattern is not meaningful if <span class="math inline">\(\rho \in (-0.15, 0.2)\)</span> for long lived species and <span class="math inline">\(\rho \in (-0.22, 0.3)\)</span> for short lived species, and note that magnitude of Mohn’s rho not related to true bias in assessment. Miller and Legault (2017) argue that variance of Mohn’s rho is truly needed to ascertain whether an effect is significant.</p></li>
</ol>
</section>
<section id="notes-and-best-practices-for-andres-rebuilder-program-aka-puntalyzer" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="notes-and-best-practices-for-andres-rebuilder-program-aka-puntalyzer"><span class="header-section-number">4.2</span> Notes and best practices for Andre’s rebuilder program (aka Puntalyzer)</h2>
<ol type="1">
<li><p>Be very afraid</p></li>
<li><p>Talk to Jason Cope, Vlada Gertseva, or Ian Taylor about what a nightmare the rebuilding analysis can be</p></li>
<li><p>Make sure the “Do West Coast gfish rebuilder output (0/1)” is set to 1 in your SS3 forecast file. This will create the output files rebuild.dat and rebuild.sso</p></li>
<li><p>Download the <a href="http://puntlab.washington.edu/software/">rebuilder executable</a></p></li>
<li><p>Figure out (from the manual perhaps) how to run the rebuilder and what modifications to your input files might be needed for what you need to do.</p></li>
<li><p>Note that the rebuilder inputs have to be formatted more carefully than SS3 inputs. Blank lines or commented lines can’t be inserted without messing things up.</p></li>
<li><p>Read the help file for <code>r4ss::DoProjectPlots</code> to learn about how to plot rebuilder output.</p></li>
</ol>
</section>
<section id="notes-and-best-practices-for-r4ss" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="notes-and-best-practices-for-r4ss"><span class="header-section-number">4.3</span> Notes and best practices for <code>r4ss</code></h2>
<ol type="1">
<li><p><code>r4ss</code> is available as an R package on CRAN but the most up-to-date version can be installed from GitHub. Installation instructions are available <a href="https://github.com/r4ss/r4ss">here</a>.</p></li>
<li><p>The GitHub page linked above include a log of changes but it’s probably a good idea to reinstall it on a regular basis to keep up.</p></li>
<li><p>Look through all the figures that get produced by <code>SS_plots</code>. Ian Stewart often said “each one of those figures is there for a reason”. There have been cases where models were put forth with incorrect assumptions about biology, ageing error, etc. that could have been caught if the assessment authors had paid attention to all the plots.</p></li>
<li><p>Remember that the figures can be modified to look better. For instance, you can replace the fleet names in the model with a less abbreviated set of names that will go in the plot labels. Almost every aspect of these plots can be modified with inputs that don’t even require recoding R (although you can always do that too).</p></li>
<li><p>If something is not working right, complain about it on the <a href="https://github.com/r4ss/r4ss/issues"><code>r4ss</code> issues list</a>.</p></li>
</ol>
</section>
<section id="notes-and-best-practices-for-writing-assessment-documents" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="notes-and-best-practices-for-writing-assessment-documents"><span class="header-section-number">4.4</span> Notes and best practices for writing assessment documents</h2>
<ol type="1">
<li><p>Read the <a href="https://www.pcouncil.org/documents/2020/05/f-2-attachment-3-draft-revised-terms-of-reference-for-the-groundfish-and-coastal-pelagic-species-stock-assessment-process-for-2021-and-2022.pdf/">terms of reference</a> and actually follow them.</p></li>
<li><p>Consider using LaTeX and .Rnw files. Chantel and Kelli are working on an R package that will serve as a template for all assessment documents and act as the successor to <a href="https://github.com/melmonk/StockAssessment_template">Melissa Monk’s template</a>. based on R Markdown.</p></li>
<li><p>If you’re using Word, talk to power users of Word about formatting of section headings, links to figures or tables, etc.. These links save much time when document is updated with sections or elements added or removed.</p></li>
</ol>
<!-- -->
<ol type="a">
<li>See the Assessment Document Template for a pre-made setup that reflects 2017-18 TORs: <code>\\nwcfile\fram\Assessments\Archives</code> and shared on the <a href="https://drive.google.com/a/noaa.gov/file/d/0B57aOEaukI73UDlNVUVNZTFScWs/view?usp=sharing">Google Drive</a></li>
</ol>
<!-- -->
<ol start="4" type="1">
<li><p>Use proper dashes and hyphens for readability: <a href="http://cutewriting.blogspot.com/2008/06/en-dash-em-dash-and-hyphen.html">Hyphen, En dash, and Em dash</a></p></li>
<li><p>Jason says: “It would be really easy to compare results of every assessment we do with the results of the data-poor methods.” He did this for Cabezon in 2009 and thinks we could do it for all our assessments.</p></li>
<li><p>For Word, consider using Endnote or Zotero to find/organize/insert references. The assessment endnote library is at <code>\\Nwcfile\fram\Assessment\References</code>, but please export references you need and do not link a Word document directly to that library.</p></li>
<li><p>Make sure that labels on Figures are readable. The best way to get figures produced in R into word is to save them as PNG files. The plotting functions in the R4SS package have an input for resolution that can be increased as needed. The default resolution is higher than what you get if you save the images one by one from the RGUI graphics window.</p></li>
<li><p>Crop out non-informative headings and labels from figures imported from R4SS or other packages.</p></li>
</ol>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./03-stock-synthesis.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Running Stock Synthesis</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./05-other.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Other useful tidbits</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>