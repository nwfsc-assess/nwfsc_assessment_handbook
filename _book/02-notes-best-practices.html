<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.38">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Unofficial NWFSC Stock Assessment Handbook - 2&nbsp; Modeling choices</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./03-stock-synthesis.html" rel="next">
<link href="./01-data-sources.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Modeling choices</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Unofficial NWFSC Stock Assessment Handbook</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/thefaylab/lab-manual" title="Source Code" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-data-sources.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Data sources: notes, contact information, and links</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-notes-best-practices.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Modeling choices</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-stock-synthesis.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Running Stock Synthesis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-post-model.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">So you ran an assessment model</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-other.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Other useful tidbits</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#notes-and-best-practices-for-selecting-maximum-age-population-and-data" id="toc-notes-and-best-practices-for-selecting-maximum-age-population-and-data" class="nav-link active" data-scroll-target="#notes-and-best-practices-for-selecting-maximum-age-population-and-data"> <span class="header-section-number">2.1</span> Notes and best practices for selecting maximum age (population and data)</a></li>
  <li><a href="#notes-and-best-practices-for-determining-prior-for-natural-mortality" id="toc-notes-and-best-practices-for-determining-prior-for-natural-mortality" class="nav-link" data-scroll-target="#notes-and-best-practices-for-determining-prior-for-natural-mortality"> <span class="header-section-number">2.2</span> Notes and best practices for determining prior for natural mortality</a></li>
  <li><a href="#notes-and-best-practices-of-estimating-ageing-error" id="toc-notes-and-best-practices-of-estimating-ageing-error" class="nav-link" data-scroll-target="#notes-and-best-practices-of-estimating-ageing-error"> <span class="header-section-number">2.3</span> Notes and best practices of estimating ageing error</a></li>
  <li><a href="#notes-and-best-practices-for-maturity" id="toc-notes-and-best-practices-for-maturity" class="nav-link" data-scroll-target="#notes-and-best-practices-for-maturity"> <span class="header-section-number">2.4</span> Notes and best practices for maturity</a></li>
  <li><a href="#notes-and-best-practices-for-fecundity" id="toc-notes-and-best-practices-for-fecundity" class="nav-link" data-scroll-target="#notes-and-best-practices-for-fecundity"> <span class="header-section-number">2.5</span> Notes and best practices for fecundity</a></li>
  <li><a href="#notes-and-best-practices-for-modeling-selectivity" id="toc-notes-and-best-practices-for-modeling-selectivity" class="nav-link" data-scroll-target="#notes-and-best-practices-for-modeling-selectivity"> <span class="header-section-number">2.6</span> Notes and best practices for modeling selectivity</a>
  <ul class="collapse">
  <li><a href="#conceptual-reasoning-for-using-different-approaches-to-selectivity" id="toc-conceptual-reasoning-for-using-different-approaches-to-selectivity" class="nav-link" data-scroll-target="#conceptual-reasoning-for-using-different-approaches-to-selectivity"> <span class="header-section-number">2.6.1</span> Conceptual reasoning for using different approaches to selectivity</a></li>
  <li><a href="#general-advice-on-selectivity-in-ss3" id="toc-general-advice-on-selectivity-in-ss3" class="nav-link" data-scroll-target="#general-advice-on-selectivity-in-ss3"> <span class="header-section-number">2.6.2</span> General advice on selectivity in SS3</a></li>
  <li><a href="#guidelines-for-ss3-double-normal-initial-setup" id="toc-guidelines-for-ss3-double-normal-initial-setup" class="nav-link" data-scroll-target="#guidelines-for-ss3-double-normal-initial-setup"> <span class="header-section-number">2.6.3</span> Guidelines for SS3 double normal initial setup</a></li>
  </ul></li>
  <li><a href="#notes-and-best-practices-for-modeling-recruitment-deviations" id="toc-notes-and-best-practices-for-modeling-recruitment-deviations" class="nav-link" data-scroll-target="#notes-and-best-practices-for-modeling-recruitment-deviations"> <span class="header-section-number">2.7</span> Notes and best practices for modeling recruitment deviations</a></li>
  <li><a href="#notes-and-best-practices-for-rockfish-steepness-profile" id="toc-notes-and-best-practices-for-rockfish-steepness-profile" class="nav-link" data-scroll-target="#notes-and-best-practices-for-rockfish-steepness-profile"> <span class="header-section-number">2.8</span> Notes and best practices for rockfish steepness profile</a></li>
  <li><a href="#stuff-to-do-well-in-advance-of-peak-stock-assessment-season" id="toc-stuff-to-do-well-in-advance-of-peak-stock-assessment-season" class="nav-link" data-scroll-target="#stuff-to-do-well-in-advance-of-peak-stock-assessment-season"> <span class="header-section-number">2.9</span> Stuff to do well in advance of peak stock assessment season</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/thefaylab/lab-manual/edit/main/02-notes-best-practices.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/thefaylab/lab-manual/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Modeling choices</span></h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<section id="notes-and-best-practices-for-selecting-maximum-age-population-and-data" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="notes-and-best-practices-for-selecting-maximum-age-population-and-data"><span class="header-section-number">2.1</span> Notes and best practices for selecting maximum age (population and data)</h2>
<p>The comments below are based on a team discussion on how to select a population and data maximum age for modeling:</p>
<p><strong>Choice 1, Population length bins:</strong> should extend beyond something like the 97.5% quantile of the length at age distribution for the largest age (easy to add more bins to see if it makes any difference).</p>
<p><strong>Choice 2, Max age:</strong> should be large enough for growth to be asymptotic, and at least as big as the largest data age bins. It’s easy to test the impact of changing to different value, just requires updating ageing error matrices. Look at the stable age-distribution plot and examine the number of fish in the plus group. Additionally, the period of time when data are available (after extensive exploitation), the data plus group may be lower.</p>
<p><strong>Choice 3, Data length bins</strong> should probably be big enough that the plus group doesn’t have much more in it than the previous bin. We should check to make sure that the selection of length and age bins are consistent with each other. Typically, we often have max length bins where there are only a few fish, but a larger proportion of data in the data age plus group.</p>
<p><strong>Choice 4, Data age bins</strong> should probably be big enough that the plus group doesn’t have much more in it than the previous bin. In regards to population maximum age, there is no negative repercussions within SS3 for having a larger value, beyond a slower run time. Revising the age bins based on the data, rather than apriori rules about how to set this, may be considered “data mining”. Could create a check within the survey and PacFIN comp codes that creates a flag when the data plus group has more than a certain percentage (i.e.&nbsp;5%). Also, add a warning to r4ss about the percentage in the population and data plus groups.</p>
</section>
<section id="notes-and-best-practices-for-determining-prior-for-natural-mortality" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="notes-and-best-practices-for-determining-prior-for-natural-mortality"><span class="header-section-number">2.2</span> Notes and best practices for determining prior for natural mortality</h2>
<p>Owen’s Advice on M; July 6, 2022</p>
<ol type="1">
<li><p>I prefer using age data alone to estimate the natural mortality rate (see accompanying document: M2017_for_Methods_Review_Hamel; Hamel and Cope (in review)), except in cases where getting a reasonable estimate of the maximum age is problematic.</p></li>
<li><p>The age based prior is simply: <span class="math display">\[\text{lognormal}(\ln(5.4/\text{max age}), 0.31).\]</span></p></li>
<li><p>The fixed value for M if not estimating is even more simply the median of that prior: <span class="math display">\[M = 5.4/\text{max age}\]</span></p></li>
<li><p>Can explore a range approaches for M estimates and priors <a href="http://barefootecologist.com.au/shiny_m">here</a>; reference is Cope and Hamel, in press.</p></li>
</ol>
</section>
<section id="notes-and-best-practices-of-estimating-ageing-error" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="notes-and-best-practices-of-estimating-ageing-error"><span class="header-section-number">2.3</span> Notes and best practices of estimating ageing error</h2>
<p>Jim Thorson has been working on this. These files are accessible <a href="https://github.com/nwfsc-assess/nwfscAgeingError">on the web</a>.</p>
<p>You can also find the original user manual that goes with the age error ADMB executable written by Andre Punt that is called by the above wrapper <a href="https://docs.google.com/a/noaa.gov/file/d/0B-5Jg3P0x9x0SnUwbnMxczBpMnM/edit?usp=sharing">on the google drive</a> The above user manual will help you understand what the program is doing and how to setup and run an individual file if you wish to do so.</p>
</section>
<section id="notes-and-best-practices-for-maturity" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="notes-and-best-practices-for-maturity"><span class="header-section-number">2.4</span> Notes and best practices for maturity</h2>
<p>Talk to Melissa Head about maturity. In 2017, she provided estimated maturity curves based on samples from the NWFSC survey for many species.</p>
<p>Data from the NWFSC survey on maturity includes a column indicating mature or immature and another indicating spawning and not spawning. The latter considers all “mature” fish with over 25% atresia as not spawning (along with all immature fish). The spawning/not spawning column is the one we commonly use to estimate the maturity curve since that is really what we care about. In some cases a simple logistic will fit, but if there is much skip spawning/atresia for older/larger females, a logistic type curve which asymptotes to a lower value or a non-parametric fit is more appropriate. A column with percent atresia is also provided if you with to use a percentage other than 25% for the cutoff. Finally, the mature/immature column can be used instead if the atresia/skip spawning is taken into account in specifying the fecundity relationship.</p>
<p>An additional column has been added to the NWFSC survey table indicating uncertainty in the designation. This can be used to weight or exclude data.</p>
<p>Note: John Field has expressed concern that we are too focused on recent samples from the NWFSC survey, so if you aren’t going to include samples from past collections, think about a justification for that choice.</p>
</section>
<section id="notes-and-best-practices-for-fecundity" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="notes-and-best-practices-for-fecundity"><span class="header-section-number">2.5</span> Notes and best practices for fecundity</h2>
<p>Update (6/05/17): EJ published <a href="http://www.sciencedirect.com/science/article/pii/S0165783616303745">a new analysis in 2017</a> which has estimates for <span class="math inline">\(aL^b\)</span> where L is in cm.</p>
<p>Ian Taylor to add his notes on how to set this up in SS3 here soon.</p>
<p>Update (11/29/16):</p>
<p>Analysis of fecundity with size can be found for many rockfishes in <a href="http://users.soe.ucsc.edu/~msmangel/Dick%20Thesis.pdf">E.J. Dick’s Dissertation</a>. The reference (from 2013 darkblotched document) is “Dick, E. J. 2009. Modeling the reproductive potential of rockfishes (Sebastes spp.). Ph.D.&nbsp;Dissertation, University of California, Santa Cruz.”</p>
<p>Chapter 3 of E.J.’s dissertation describes his methods. Tables 10 and 11 list parameters (for each species that E.J. considered), which include the intercept and the slope in the 2-level hierarchical model for relative fecundity as a linear function of weight. The intercept is a scalar (eggs/kg at ‘zero’ weight), and the slope is the expected increase in weight-specific fecundity per additional kg of weight. Note that you want to use the median (50%) value from those tables.</p>
<p>The units of the response variable for SS3 fecundity option #1 are eggs/kg. E.J.’s regression for SS3 option #1 was in grams; therefore, we need to multiply the intercept by 1,000 and the slope by 1,000,000 to convert to kg (since that model is quadratic in W).</p>
<p>So using darkblotched as an example, for fecundity option #1 in SS3, the parameters to enter into the control file are: <code>alpha = 101,100</code> and <code>beta = 44,800</code></p>
<p>For another example see the control file in the 2009 or 2011 yelloweye assessments and for Ian S.’s text see section 2.2.3 in the 2009 yelloweye assessment. Note that the comment in the control file has ‘eggs/cm’ however the conversion is made and this should be ‘eggs/kg’</p>
<p>Here is bit of R code from John Wallace to see that this is the correct approach:</p>
<pre><code>x.gm &lt;- seq(1, 10, length = 2000)
y.eggs.per.gm  &lt;- rnorm(2000, 2 + 3*x.gm)
plot(x.gm, y.eggs.per.gm)
summary(glm(y.eggs.per.gm ~ x.gm))

x.kg &lt;- x.gm/1000
y.eggs.per.kg  &lt;- y.eggs.per.gm * 1000
plot(x.kg, y.eggs.per.kg)
summary(glm(y.eggs.per.kg ~ x.kg))</code></pre>
<p>The r4ss figure bio6_fecundity.png shows the resulting relationship so you can use that to determine whether your parameter values produce the correct final relationship.</p>
</section>
<section id="notes-and-best-practices-for-modeling-selectivity" class="level2" data-number="2.6">
<h2 data-number="2.6" class="anchored" data-anchor-id="notes-and-best-practices-for-modeling-selectivity"><span class="header-section-number">2.6</span> Notes and best practices for modeling selectivity</h2>
<p>Ian Taylor and Jim Thorson will fill in some notes here based on the CAPAM selectivity workshop held in La Jolla on March 11-14, 2013. The notes below are a start suggested by Mark Maunder.</p>
<p>[update: as of July 2, 2014, Ian and Jim haven’t added anything to the text below but the Special Issue of Fisheries Science associated with the CAPAM meeting isn’t yet publicly available (it’s close)]</p>
<section id="conceptual-reasoning-for-using-different-approaches-to-selectivity" class="level3" data-number="2.6.1">
<h3 data-number="2.6.1" class="anchored" data-anchor-id="conceptual-reasoning-for-using-different-approaches-to-selectivity"><span class="header-section-number">2.6.1</span> Conceptual reasoning for using different approaches to selectivity</h3>
<p><strong>The following set of circumstances might cause selectivity to be dome-shaped:</strong></p>
<ol type="1">
<li><p>Contact selectivity causing older fish to outswim the trawl, or escape the gillnet/hooks</p></li>
<li><p>Incomplete spatial coverage in terms of depth or untrawlable habitat</p></li>
<li><p>Spatial heterogeneity in fishing intensity (see Sampson paper). This probably applies more to fishery selectivity than surveys.</p></li>
</ol>
<p><strong>Reasons for justifying asymptotic selectivity</strong></p>
<ol type="1">
<li></li>
</ol>
</section>
<section id="general-advice-on-selectivity-in-ss3" class="level3" data-number="2.6.2">
<h3 data-number="2.6.2" class="anchored" data-anchor-id="general-advice-on-selectivity-in-ss3"><span class="header-section-number">2.6.2</span> General advice on selectivity in SS3</h3>
<ol type="1">
<li><p>Start with a functional form that is commonly used (double normal)</p></li>
<li><p>Find some initial values using either the Excel spreadsheets or the r4ss widgets</p></li>
<li><p>Put the initial values in the model and run without estimating anything until you get a model that runs. This can be done by setting the maximum phase in the starter file to 0 or (better), by using the command line inputs: “-maxfn 0 -nohess”</p></li>
<li><p>Read the output into R using SS_output and plot the selectivity using either SS_plots(…, plot=2) or SSplotSelex(…,subplot=1), where … is the object created by SS_output.</p></li>
<li><p>Set the PHASE for as many parameters to negative values as possible so that you start with estimating relatively few parameters (such as parameters 1 and 3 of the double normal, which control the peak and ascending slope).</p></li>
</ol>
</section>
<section id="guidelines-for-ss3-double-normal-initial-setup" class="level3" data-number="2.6.3">
<h3 data-number="2.6.3" class="anchored" data-anchor-id="guidelines-for-ss3-double-normal-initial-setup"><span class="header-section-number">2.6.3</span> Guidelines for SS3 double normal initial setup</h3>
<ul>
<li><p>Fix parameters 5 and 6 (negative phase).</p>
<ul>
<li><p>If selectivity is thought to be zero at the youngest/smallest or the oldest/biggest fish set the value to zero (e.g -15)</p></li>
<li><p>If selectivity is thought to be larger than zero at the youngest/smallest or the oldest/biggest fish set the value to -999 (does not scale the selectivity for the youngest or oldest age, independently from the normal curve).</p></li>
</ul></li>
<li><p>Fix the plateau (parameter 2) to be small values (e.g.&nbsp;-15).</p></li>
<li><p>Set the peak (parameter 1) at the age/length equal to the mode of the composition data</p></li>
<li><p>Set the ascending (parameter 3) and descending (parameter 4) slopes at ln( (peak_age-youngest_age)<em>8) and ln( (oldestyoungest_age-peak_age)</em>8)</p></li>
<li><p>Don’t estimate selectivity at youngest age/size (parameter 5), either fix at -5 or -999</p></li>
<li><p>Use the double normal for asymptotic selectivity so have flexibility of dome shape without major changes to control file, plus have control over selectivity at the youngest age.</p>
<ul>
<li><p>Fix descending slope (parameter 4) at a large number (e.g.&nbsp;15)</p></li>
<li><p>Alternative 1: Fix plateau (parameter 2) to a large number (e.g.&nbsp;15)</p></li>
<li><p>Alternative 2: Fix selectivity of the oldest age (parameter 6) at a large number (e.g.&nbsp;15).</p></li>
</ul></li>
</ul>
</section>
</section>
<section id="notes-and-best-practices-for-modeling-recruitment-deviations" class="level2" data-number="2.7">
<h2 data-number="2.7" class="anchored" data-anchor-id="notes-and-best-practices-for-modeling-recruitment-deviations"><span class="header-section-number">2.7</span> Notes and best practices for modeling recruitment deviations</h2>
<ol type="1">
<li><p>Choices to be made:</p>
<ol type="a">
<li><p>allow recruitment deviations or not?</p></li>
<li><p>range of years?</p></li>
<li><p>breaking into “early”, “main”, “late” vectors?</p>
<ol type="i">
<li>early and late vectors are intended to add uncertainty to the model for years with little or no data with information about recruitment</li>
</ol></li>
</ol></li>
<li><p>What was done in the 2011 assessments? Graphical description is <a href="https://docs.google.com/a/noaa.gov/file/d/0B5lSVg5Eq86uX250WHJXUWt0T1E/edit">here</a>.</p></li>
<li><p>Guidance on bias adjustment settings</p>
<ol type="a">
<li>Multiple simulation analyses have shown that applying the bias adjustment settings given by the <code>r4ss::SS_fitbiasramp()</code> perform well on average. However, there’s no guarantee that this will work well in any given circumstance. User discretion is advised.</li>
</ol></li>
<li><p>What to do about <span class="math inline">\(\sigma_R\)</span>.</p>
<ol type="1">
<li><p>Simulation in <a href="http://www.nrcresearchpress.com/doi/abs/10.1139/f2011-092">Methot and Taylor (2011)</a> looked at a few options.</p>
<ol type="i">
<li><p>Estimating <span class="math inline">\(\sigma_R\)</span> . <strong>Performed well under ideal circumstances.</strong></p></li>
<li><p>Tune <span class="math inline">\(\sigma_R\)</span> to match the observed variability in recruitment deviations. <span class="math display">\[ {\sigma_R}^2 = \text{sd}(r')^2 \]</span> <strong>Performed less well.</strong></p></li>
<li><p>Tune <span class="math inline">\(\sigma_R\)</span> so that <span class="math display">\[{\sigma_R}^2 = \text{sd}(r')2 + \text{mean}(\text{SE}(r'))^2\]</span> where <span class="math inline">\(\text{sd}(r')\)</span> is the standard deviation of the vector of estimated recruitments over a range of years that seem reasonably well informed by the data, and <span class="math inline">\(\text{mean}(\text{SE}(r'))\)</span> is the mean of the estimated variability of those values. <strong>Performed best.</strong></p></li>
</ol></li>
</ol></li>
<li><p>MCMC</p>
<ol type="a">
<li>If you can get MCMC to work for your model, all the worry about bias adjustment goes away. You would need to either estimate <span class="math inline">\(\sigma_R\)</span> in the MCMC and hope it converges, or fix it at a value that has been tuned to the MLE.</li>
</ol></li>
<li><p>Autocorrelated recruitment deviations</p>
<ol type="a">
<li><p>Estimate <code># SR_autocorr</code> (Stock-Recruit parameter in control file)</p></li>
<li><p>Here are results from hake in 2019 from the ss_new file: <code>-1 1 -0.155106 0 99 0 6 0 0 0 0 0 0 0 # SR_autocorr</code></p></li>
<li><p><a href="https://www.sciencedirect.com/science/article/abs/pii/S0165783616301928">Johnson et al.&nbsp;(2016)</a> estimated autocorrelation in a simulation context</p></li>
</ol></li>
</ol>
</section>
<section id="notes-and-best-practices-for-rockfish-steepness-profile" class="level2" data-number="2.8">
<h2 data-number="2.8" class="anchored" data-anchor-id="notes-and-best-practices-for-rockfish-steepness-profile"><span class="header-section-number">2.8</span> Notes and best practices for rockfish steepness profile</h2>
<p>Pacific rockfishes use a prior on steepness (or the predictive mean from this prior). A method was developed to develop this prior by Martin Dorn in 2007, and updated by Dorn in 2009/2011. It was then rebuilt by James Thorson, who updated it in 2013/2015/2017. Starting in 2019 the update will be conducted by Chantel Wetzel</p>
<ul>
<li><p>The method is fully described in <a href="https://doi.org/10.1016/j.fishres.2018.03.014">Thorson, Dorn, and Hamel (2018) Fisheries Research</a></p></li>
<li><p>The method can be replicated for any data set 2007/2009/2011/2013/2015/2017 using R package <a href="https://github.com/James-Thorson/SebastesSteepness">SebastesSteepness</a></p></li>
<li><p>The rationale for excluding a species when developing a prior for a given focal species (termed “Type-C” meta-analysis) is explained <a href="http://www.nrcresearchpress.com/doi/abs/10.1139/f04-245">in this paper</a></p>
<ul>
<li>If you are assessing any of the following species you will need to obtain a “Type-C” prior: aurora, black, bocaccio, canary, chilipepper, darkblotched, gopher, splitnose, widow, yelloweye, yellowtail north</li>
</ul></li>
<li><p>The estimated prior by year is as follows:</p>
<ul>
<li><p>2007: mean = 0.58, sd = 0.181</p></li>
<li><p>2009: mean = 0.69, sd = 0.218</p></li>
<li><p>2011: mean = 0.76, sd = 0.170</p></li>
<li><p>2013: mean = 0.78, sd = 0.152</p></li>
<li><p>2015: mean = 0.77, sd = 0.147</p></li>
<li><p>2017: mean = 0.72, sd = 0.158</p></li>
</ul></li>
</ul>
</section>
<section id="stuff-to-do-well-in-advance-of-peak-stock-assessment-season" class="level2" data-number="2.9">
<h2 data-number="2.9" class="anchored" data-anchor-id="stuff-to-do-well-in-advance-of-peak-stock-assessment-season"><span class="header-section-number">2.9</span> Stuff to do well in advance of peak stock assessment season</h2>
<p>Contact <del>Martin Dorn</del> <del>Jim Thorson</del> Chantel Wetzel (ugh) for the current assessment cycle steepness prior. If you are conducting an assessment on a rockfish species that is included in the steepness profile (aurora, black, bocaccio, canary, chilipepper, darkblotched, gopher, splitnose, widow, yelloweye, yellowtail north), contact Chantel Wetzel for a “type-C” prior with your species removed.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./01-data-sources.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Data sources: notes, contact information, and links</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./03-stock-synthesis.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Running Stock Synthesis</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>